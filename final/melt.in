# ================================
# melt.in
# Liquido LJ (~500 atomos) a T = 2.5
# rho ≈ 1.09, PBC, COM fijo
# ================================

# ---- Inicializacion ----
units           lj
atom_style      atomic
boundary        p p p

# ---- Lattice y caja ----
# fcc con densidad LJ = 1.09 (como en el paper)
lattice         fcc 1.09

# Caja: 5x5x5 celdas en unidades de lattice → 500 atomos
region          box block 0 5 0 5 0 5 units lattice
create_box      1 box
create_atoms    1 box

mass            1 1.0

# Comprobar numero de atomos
variable        natoms equal count(all)
print "Numero total de atomos creados = ${natoms}"

# ---- Potencial Lennard-Jones ----
pair_style      lj/cut 2.5
pair_coeff      1 1 1.0 1.0 2.5

neighbor        0.3 bin
neigh_modify    every 1 delay 0 check yes

# ---- Dinamica: Langevin + NVE ----
timestep        0.005

# Velocidades iniciales a T = 2.5
velocity        all create 2.5 12345 mom yes rot yes dist gaussian

# Termostato de Langevin a 2.5
fix             fT   all langevin 2.5 2.5 1.0 48279
fix             int  all nve

# Fijar centro de masa en el centro de la caja
# (ponerlo DESPUES de los fixes de integracion para evitar el warning)
fix             keepCOM all recenter 0.5 0.5 0.5 units fraction

# (Fisicamente mas razonable si no quieres "teletransportar" el cluster:
#  fix mom all momentum 100 linear 1 1 1)

# ---- Output ----
thermo          200
thermo_style    custom step temp pe ke etotal press

dump            pos all atom 500 dump.500atoms_T2p5.lammpstrj
dump_modify     pos sort id

# ---- Run ----
run             20000

# (opcional) quitar Langevin y dejar un poco en NVE a T~2.5
unfix           fT
run             5000

# Guardar configuracion liquida
write_data      liquid_500atoms_T2p5_rho1p09.lmpdat

